# CVE-2022-0778
#
# In order to support FIPS with OpenSSL we are required to use OpenSSL version
# 1.0.2 until OpenSSL supports the FIPS module in newer versions. The latest
# available version to us is 1.0.2zg, which includes this fix. Trivy does not
# recognize 1.0.2zg as a valid fixed version, hence the need for this ignore.
#
# Performed by @samirshetty, approved by @andytinkham
CVE-2022-0778

# CVE-2021-3711
# OpenSSL statement https://www.openssl.org/news/secadv/20210824.txt
# SM2 explanation https://www.openssl.org/docs/manmaster/man7/SM2.html
# The vulnerability does not affect Conjur's version of OpenSSL 1.0.2zg
# Conjur does not use SM2 algorithm
# The vulnerability does affect nignx, postgres, syslog-ng version of OpenSSL 1.1.1
# nignx, postgres, syslog-ng does not use SM2 algorithm
# if there will be a need in the SM* algorithms OpenSSL 1.1.1 Ubuntu package should be updated to the last version
# There's a test in the appliance build that validates that the algs are not in list
# features/tls_min_version_verification.feature
CVE-2021-3711

# CVE-2020-1967
# Applications that call the SSL_check_chain() function during or after a TLS 1.3 handshake
# may crash due to a NULL pointer dereference as a result of incorrect handling of the "signature_algorithms_cert"
# TLS extension. this issue was fixed in OpenSSL 1.1.1g
#
# In order to support fips with openssl we are required to downgrading openssl version to 1.0.2 until openssl will
# support fips module in newer versions
# This vulnerability this is not relevant to us as
# 1. The installed version (1.0.2zg) does not support 1.3
# 2. Trivy detect the usage of openssl 1.0.2 (can be reproduced with
#    docker run -v /var/run/docker.sock:/var/run/docker.sock
#   -v $(PWD):/workspace --rm aquasec/trivy -f json -o /workspace/scan_results-conjur-unfixed.json --no-progress
#   --ignorefile .trivyignore registry.tld/ruby-fips-base-image-phusion:1.0.0)
#
# Performed by @yahalomk approved by @shaharglazner
CVE-2020-1967

# CVE-2020-1971
# The X.509 GeneralName type is a generic type for representing different types
# of names. One of those name types is known as EDIPartyName. OpenSSL provides a
# function GENERAL_NAME_cmp which compares different instances of a GENERAL_NAME
# to see if they are equal or not. This function behaves incorrectly when both
# GENERAL_NAMEs contain an EDIPARTYNAME. A NULL pointer dereference and a crash
# may occur leading to a possible denial of service attack.
# OpenSSL itself uses the GENERAL_NAME_cmp function for two purposes:
#
# 1) Comparing CRL distribution point names between an available CRL and a CRL
#    distribution point embedded in an X509 certificate.
#
# 2) When verifying that a timestamp response token signer matches the timestamp
#    authority name (exposed via the API functions TS_RESP_verify_response and
#    TS_RESP_verify_token) If an attacker can control both items being compared
#    then that attacker could trigger a crash.
#
# All OpenSSL 1.1.1 and 1.0.2 versions are affected by this issue. Fixed in OpenSSL
# 1.1.1i (Affected 1.1.1-1.1.1h). Fixed in OpenSSL 1.0.2x (Affected 1.0.2-1.0.2w).
#
# In order to support FIPS with OpenSSL we are required to use OpenSSL version
# 1.0.2 until OpenSSL supports the FIPS module in newer versions. The latest
# available version to us is 1.0.2u, which does not include this fix.
#
# We've determined that we are not impacted by this vulnerability because:
# - we do not directly perform CRL checks in the Conjur or DAP software
# - we do not enable automatic CRL checks in openssl tools
# - we do not call any of the impacted OpenSSL APIs or any of the APIs that expose
#   impacted behavior.
#
# Performed by @micahlee, approved by @andytinkham
CVE-2020-1971

# CVE-2021-3449
# An OpenSSL TLS server may crash if sent a maliciously crafted renegotiation
# ClientHello message from a client. If a TLSv1.2 renegotiation ClientHello
# omits the signature_algorithms extension (where it was present in the initial
# ClientHello), but includes a signature_algorithms_cert extension then a NULL
# pointer dereference will result, leading to a crash and a denial of service
# attack. A server is only vulnerable if it has TLSv1.2 and renegotiation
# enabled (which is the default configuration). OpenSSL TLS clients are not
# impacted by this issue. All OpenSSL 1.1.1 versions are affected by this issue.
# Users of these versions should upgrade to OpenSSL 1.1.1k. OpenSSL 1.0.2 is
# not impacted by this issue. Fixed in OpenSSL 1.1.1k (Affected 1.1.1-1.1.1j).
#
# We've determined that we are not impacted by this vulnerability because:
# - we use OpenSSL 1.0.2, which is not impacted
#
# Performed by @jtuttle, approved by @andytinkham
CVE-2021-3449

# We have the fix for this CVE in place. However, trivy still detects
# it because it doesn't handle the 1.0.2 line available only by premium 
# support and thus thinks we're still vulnerable. 
CVE-2023-0286

# Scanners have started flagging CVE-2017-14033 because they are matching 
# the version of Ruby that shipped the vulnerable openssl gem with the 
# version of openssl itself. We use Ruby 3 in our base images, so already
# have the fix for this issue.
CVE-2017-14033
